<div class="page-container">
  <div class="page-header">
    <div>
      <h1>Gestión de Encuestas</h1>
      <p class="subtitle">Crea y administra encuestas para estudiantes</p>
    </div>
    <button class="btn-primary" routerLink="/encuestas/nuevo">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
      Nueva Encuesta
    </button>
  </div>

  <!-- Estadísticas -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon total">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 11H3v2h6m1-6H4v2h6m-6 7h6v-2H4m15.5-5c.66 0 1.25.42 1.42 1.01l1.08 3.6c.06.17.1.35.1.53V15c0 .55-.45 1-1 1h-1v1.5c0 .83-.67 1.5-1.5 1.5S17 18.33 17 17.5V16H9v1.5c0 .82-.67 1.5-1.5 1.5S6 18.32 6 17.5V16H3c-.55 0-1-.45-1-1v-1.86c0-.18.04-.36.1-.53l1.08-3.6C3.35 8.42 3.94 8 4.6 8H8v3z"></path>
        </svg>
      </div>
      <div class="stat-info">
        <span class="stat-value">{{ estadisticas.total }}</span>
        <span class="stat-label">Total</span>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon activas">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
        </svg>
      </div>
      <div class="stat-info">
        <span class="stat-value">{{ estadisticas.activas }}</span>
        <span class="stat-label">Activas</span>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon borradores">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
      </div>
      <div class="stat-info">
        <span class="stat-value">{{ estadisticas.borradores }}</span>
        <span class="stat-label">Borradores</span>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon visibles">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
          <circle cx="12" cy="12" r="3"></circle>
        </svg>
      </div>
      <div class="stat-info">
        <span class="stat-value">{{ estadisticas.visibles }}</span>
        <span class="stat-label">Visibles</span>
      </div>
    </div>
  </div>

  <!-- Filtros -->
  <div class="filters-bar">
    <div class="search-box">
      <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.35-4.35"></path>
      </svg>
      <input 
        type="text" 
        placeholder="Buscar encuestas..."
        (input)="onSearchChange($event)"
      />
    </div>

    <div class="filters">
      <select (change)="onFiltroEstadoChange($event)">
        <option value="todos">Todos los estados</option>
        <option value="activa">Activas</option>
        <option value="borrador">Borradores</option>
        <option value="cerrada">Cerradas</option>
      </select>

      <select (change)="onFiltroVisibilidadChange($event)">
        <option value="todos">Todas</option>
        <option value="visible">Visibles</option>
        <option value="oculto">Ocultas</option>
      </select>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Cargando encuestas...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error" class="error-message">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="12" y1="8" x2="12" y2="12"></line>
      <line x1="12" y1="16" x2="12.01" y2="16"></line>
    </svg>
    <p>{{ error }}</p>
    <button class="btn-secondary" (click)="loadEncuestas()">Reintentar</button>
  </div>

  <!-- Grid -->
  <div *ngIf="!loading && !error" class="encuestas-grid">
    <app-encuesta-card 
      *ngFor="let encuesta of encuestasFiltradas"
      [encuesta]="encuesta"
      (delete)="deleteEncuesta($event)"
      (toggleVisible)="toggleVisible($event)"
      (cambiarEstado)="cambiarEstado($event)">
    </app-encuesta-card>

    <div *ngIf="encuestasFiltradas.length === 0" class="empty-state">
      <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M9 11H3v2h6m1-6H4v2h6m-6 7h6v-2H4m15.5-5c.66 0 1.25.42 1.42 1.01l1.08 3.6c.06.17.1.35.1.53V15c0 .55-.45 1-1 1h-1v1.5c0 .83-.67 1.5-1.5 1.5S17 18.33 17 17.5V16H9v1.5c0 .82-.67 1.5-1.5 1.5S6 18.32 6 17.5V16H3c-.55 0-1-.45-1-1v-1.86c0-.18.04-.36.1-.53l1.08-3.6C3.35 8.42 3.94 8 4.6 8H8v3z"></path>
      </svg>
      <p>{{ searchTerm || filtroEstado !== 'todos' ? 'No se encontraron encuestas' : 'No hay encuestas registradas' }}</p>
      <button class="btn-primary" routerLink="/encuestas/nuevo" *ngIf="encuestas.length === 0">
        Crear Primera Encuesta
      </button>
    </div>
  </div>
</div>